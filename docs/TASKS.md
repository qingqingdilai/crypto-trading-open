# 任务分解（Tasks / Backlog）

## 优先级说明
- P0：影响正确性/稳定性的关键问题，需优先解决
- P1：重要改进，提升可观测性/可维护性/性能
- P2：体验与工程化增强

## P0（短期）
- 精度一致性与匹配
  - 检查所有下单价格与查询匹配逻辑，统一按 `price_decimals` 与 `quantity_precision` 量化（网格已修复 Follow 动态区间）
  - 排查订单索引匹配处是否仍使用未量化的价格
- WebSocket 可靠性
  - 各交易所 WS 心跳 + 自动重连路径回归测试
  - 用户流（订单更新）缺失时的降级与兜底逻辑
- 退出清理一致性
  - 任意阶段 Ctrl+C / Q：确保撤单、必要的平仓与断连均执行
- 配置校验
  - 针对 `config/grid/*.yaml` 与 `config/volume_maker/*.yaml` 增强启动前的字段验证与人性化报错

## P1（中期）
- 监控与指标
  - 输出关键指标：订单成功率、平均确认时延、WS 重连次数、REST 调用次数/速率、策略循环耗时
  - 统一指标接口，便于未来 Prometheus/OTel 接入
- 限频与重试策略
  - 按交易所抽象限频器；REST 调用重试（指数退避）与幂等策略
- 日志与可观测性
  - 明确每类关键事件的日志级别与字段（下单、撤单、重连、降级）
  - 增加异常上下文（exchange_id、symbol、client_id、latency）
- 测试覆盖
  - 适配器：下单/撤单/订阅/心跳
  - 网格：索引换算、健康检查、风控组件（剥头皮、止损、价格锁定）
  - 刷量：`client_id + WS` 路径、超时回退 REST、滑点阶梯

## P2（工程化）
- 容器与打包
  - 可选 Docker 镜像；示例 compose；本地与云端一键启动脚本
- 配置与文档
  - 各交易所 API Key/Passphrase 配置模板与说明完善
  - “多交易所符号转换参考”与“精度配置最佳实践”
- 可扩展性
  - 新交易所接入脚手架（接口模版 + 最小可用实现 + 验证脚本）
  - 策略插件化机制的提案与 PoC

## 后续建议
- 在测试账户与小额资金下进行端到端验证
- 若需要远程监控/观测，新增轻量 HTTP/WS 导出指标与状态
- 根据实际运行反馈持续扩充 FAQ 与 Troubleshooting

